{% extends 'base.html.twig' %}

{% block body %}
    <div style="max-width: 900px; margin: auto; padding: 2rem; background-color: #f7f7f7; border-radius: 8px;">
        <div style="margin-bottom: 1rem; display: flex; gap: 1rem;">
            <a href="{{ path('app_Clocking_create') }}"
               style="text-decoration: none; background-color: #333; color: white; padding: 0.5rem 1rem; border-radius: 4px;">
                + CrÃ©er un pointage (collaborateur)
            </a>
            <a href="{{ path('app_clocking_multi') }}"
               style="text-decoration: none; background-color: #333; color: white; padding: 0.5rem 1rem; border-radius: 4px;">
                + Pointage multiple (chef de project)
            </a>
        </div>

        <table style="width: 100%; border-collapse: collapse; font-family: sans-serif;">
            <thead>
                <tr style="background-color: #333; color: white;">
                    <th style="padding: 0.75rem; text-align: left;">Date</th>
                    <th style="padding: 0.75rem; text-align: left;">Chantier</th>
                    <th style="padding: 0.75rem; text-align: left;">Collaborateurs</th>
                    <th style="padding: 0.75rem; text-align: left;">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for date, projects in groupedClockings %}
                    {% for projectName, entries in projects %}
                        <tr style="background-color: {{ loop.parent.loop.index is odd ? '#fff' : '#eee' }};">
                            <td style="padding: 0.75rem;">{{ date|date('d/m/Y') }}</td>
                            <td style="padding: 0.75rem;">ðŸ›  {{ projectName }}</td>
                            <td style="padding: 0.75rem;">
                                <ul style="margin: 0; padding-left: 1rem;">
                                    {% for entry in entries %}
                                        <li>
                                            ðŸ‘¤ {{ entry.user.lastName }} {{ entry.user.firstName }} : {{ entry.duration }}h
                                        </li>
                                    {% endfor %}
                                </ul>
                            </td>
                            <td style="padding: 0.75rem;">
                                {% for entry in entries %}
                                    <div>
                                        <a href="{{ path('app_Clocking_delete', {id: entry.clocking_id}) }}"
                                           style="color: #a00; text-decoration: none; font-weight: bold;">
                                            Supprimer 
                                        </a>
                                    </div>
                                {% endfor %}
                            </td>
                        </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="4" style="padding: 1rem; text-align: center; color: #666;">
                            Aucun pointage pour le moment.
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}
